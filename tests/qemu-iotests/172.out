QA output created by 172
Formatting 'TEST_DIR/t.IMGFMT', fmt=IMGFMT size=737280
Formatting 'TEST_DIR/t.IMGFMT.2', fmt=IMGFMT size=737280
Formatting 'TEST_DIR/t.IMGFMT.3', fmt=IMGFMT size=737280


=== Default ===

Testing:

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"


=== Using -fda/-fdb options ===

Testing: -fda TEST_DIR/t.qcow2

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fdb TEST_DIR/t.qcow2

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"
floppy1 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

floppy0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fda TEST_DIR/t.qcow2 -fdb TEST_DIR/t.qcow2.2

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

floppy1 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fdb 

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"


=== Using -drive options ===

Testing: -drive if=floppy,file=TEST_DIR/t.qcow2

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=floppy,file=TEST_DIR/t.qcow2,index=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"
floppy1 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

floppy0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=floppy,file=TEST_DIR/t.qcow2 -drive if=floppy,file=TEST_DIR/t.qcow2.2,index=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

floppy1 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit



=== Using -drive if=none and -device ===

Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,unit=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0 -device floppy,drive=none1,unit=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none1 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit



=== Mixing -fdX and -global ===

Testing: -fda TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -global floppy.drive=none0
QEMU_PROG: -global floppy.drive=... conflicts with drive=floppy0


=== Mixing -fdX and -device ===

Testing: -fda TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fda TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fdb TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy1 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fdb TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "floppy1"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy1 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -fda TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=0
QEMU_PROG: -device floppy,drive=none0,unit=0: Floppy unit 0 is in use

Testing: -fdb TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=1
QEMU_PROG: -device floppy,drive=none0,unit=1: Floppy unit 1 is in use


=== Mixing -drive and -device ===

Testing: -drive if=floppy,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=floppy,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=1

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 1 (0x1)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
floppy0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

none0 (NODE_NAME): TEST_DIR/t.qcow2.2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=floppy,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -device floppy,drive=none0,unit=0
QEMU_PROG: -device floppy,drive=none0,unit=0: Floppy unit 0 is in use


=== Mixing -global and -device ===

Testing: -drive if=none,file=TEST_DIR/t.qcow2 -global floppy.drive=none0 -device floppy,unit=0

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -global floppy.drive=none0 -device floppy,drive=none1,unit=0
QEMU_PROG: -device floppy,drive=none1,unit=0: -global floppy.drive=... conflicts with drive=none1


=== Attempt to use drive twice ===

Testing: -drive if=none -device floppy,drive=none0 -device floppy -device floppy,drive=none0
QEMU_PROG: -device floppy,drive=none0: Drive 'none0' is already in use by another device

Testing: -drive if=none -global floppy.drive=none0 -device floppy -device floppy
QEMU_PROG: -device floppy: can't apply global floppy.drive=none0: Drive 'none0' is already in use by another device

Testing: -fda  -device floppy,drive=floppy0
QEMU_PROG: -device floppy,drive=floppy0: Drive 'floppy0' is already in use because it has been automatically connected to another device (did you need 'if=none' in the drive options?)

Testing: -fda  -global floppy.drive=floppy0
QEMU_PROG: -global floppy.drive=... conflicts with drive=floppy0

Testing: -device floppy,drive=floppy0
QEMU_PROG: -device floppy,drive=floppy0: Property 'floppy.drive' can't find value 'floppy0'


=== Too many floppy drives ===

Testing: -drive if=floppy,file=TEST_DIR/t.qcow2 -drive if=none,file=TEST_DIR/t.qcow2.2 -drive if=none,file=TEST_DIR/t.qcow2.3 -device floppy,drive=none0 -device floppy,drive=none1
QEMU_PROG: -device floppy,drive=none1: Can't create floppy unit 2, bus supports only 2 units


=== Creating an empty drive with anonymous BB ===

Testing: -device floppy

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = ""
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"

Testing: -device floppy,drive-type=120

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = ""
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "120"

Testing: -device floppy,drive-type=144

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = ""
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"

Testing: -device floppy,drive-type=288

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = ""
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"


=== Try passing different drive size with image ===

Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,drive-type=120

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "120"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,drive-type=288

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "288"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit



=== Try passing different block sizes ===

Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,logical_block_size=512

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,physical_block_size=512

          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "none0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
none0 (NODE_NAME): TEST_DIR/t.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[N]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0: [not inserted]
    Attached to:      /machine/unattached/device[N]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed
(qemu) quit


Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,logical_block_size=4096
QEMU_PROG: -device floppy,drive=none0,logical_block_size=4096: logical_block_size > physical_block_size not supported

Testing: -drive if=none,file=TEST_DIR/t.qcow2 -device floppy,drive=none0,physical_block_size=1024
QEMU_PROG: -device floppy,drive=none0,physical_block_size=1024: Physical and logical block size must be 512 for floppy


=== Writethrough caching ===
    Cache mode:       writeback
    Cache mode:       writeback
    Cache mode:       writethrough
*** done
